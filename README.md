# JavaScript Runtimes Benchmark Suite

Научная система бенчмаркинга для сравнения производительности JavaScript рантаймов (Node.js, Deno, Bun).

## Описание

Данный проект предоставляет инструменты для объективного сравнения производительности различных JavaScript рантаймов путем запуска идентичных тестов в изолированных контейнерах Docker.

Ключевые особенности:
- Контейнеризованные тесты для каждого рантайма (Node.js, Deno, Bun)
- Обход оптимизаций движков для более объективных сравнений
- Подробный сбор метрик (время выполнения, использование памяти)
- Последовательный запуск тестов для исключения влияния параллельных нагрузок
- Гибкая система запуска тестов с помощью Docker Compose
- Инструменты для анализа и визуализации результатов

## Реализованные тесты

1. **Fibonacci** - рекурсивный и итеративный расчет чисел Фибоначчи
2. **Sorting** - алгоритмы сортировки массивов (QuickSort, сортировка вставками)
3. **Matrix** - умножение матриц (наивный и оптимизированный алгоритмы)
4. **JSON** - операции с JSON (сериализация/десериализация, клонирование)

## Установка и настройка

### Требования

- Docker и Docker Compose
- Node.js (для анализа результатов)
- Gnuplot (опционально, для визуализации результатов)

### Клонирование репозитория

```bash
git clone https://github.com/yourusername/runtimes-benchmarks.git
cd runtimes-benchmarks
```

## Запуск бенчмарков

Для запуска тестов используйте скрипт `run-benchmarks.sh`. Все тесты запускаются последовательно для исключения конкуренции за ресурсы, что обеспечивает более точные результаты:

```bash
# Запуск всех тестов для всех рантаймов
./run-benchmarks.sh --all

# Запуск теста Фибоначчи только для Node.js
./run-benchmarks.sh -r node -t fibonacci

# Запуск всех тестов для Bun
./run-benchmarks.sh -r bun

# Запуск теста JSON для всех рантаймов
./run-benchmarks.sh -t json
```

Параметры:
- `-a, --all` - запустить все тесты для всех рантаймов
- `-r, --runtime RUNTIME` - запустить тесты только для указанного рантайма (node, deno, bun)
- `-t, --test TEST` - запустить только указанный тест (fibonacci, sorting, matrix, json)
- `-h, --help` - показать справку

После запуска каждого теста скрипт делает короткую паузу для стабилизации системы, а затем приступает к следующему тесту. Это гарантирует, что каждый тест выполняется в аналогичных условиях.

## Анализ результатов

После запуска тестов результаты сохраняются в директории `./results`. Для анализа и визуализации используйте скрипт `analyze-results.js`:

```bash
./analyze-results.js
```

Скрипт создает:
- Текстовые таблицы с результатами
- Сравнительный анализ по каждому типу теста
- Графики производительности (при наличии Gnuplot)

## Структура проекта

```
benchmark-suites/       # Исходный код тестов
├── metrics-interface.mjs   # Общий интерфейс для метрик
├── node/                   # Тесты для Node.js
│   ├── fibonacci/          # Тест Фибоначчи
│   ├── sorting/            # Тест сортировки
│   ├── matrix/             # Тест умножения матриц
│   ├── json/               # Тест JSON
│   └── utils/              # Утилиты для Node.js
├── deno/                   # Тесты для Deno (аналогичная структура)
└── bun/                    # Тесты для Bun (аналогичная структура)

docker/                 # Конфигурации Docker
├── node/                   # Dockerfile для Node.js
├── deno/                   # Dockerfile для Deno
└── bun/                    # Dockerfile для Bun

docker-compose.yml      # Конфигурация Docker Compose
run-benchmarks.sh       # Скрипт запуска тестов
analyze-results.js      # Скрипт анализа результатов
results/                # Директория для результатов
charts/                 # Сгенерированные графики
```

## Обход оптимизаций

Для более объективного сравнения рантаймов применяются техники обхода оптимизаций движков:

1. **V8 (Node.js, Deno)**:
   - Предотвращение встраивания функций
   - Создание мегаморфных мест вызова
   - Предотвращение предсказуемости типов данных
   - Случайная сборка мусора

2. **JavaScriptCore (Bun)**:
   - Предотвращение DFG/FTL компиляции
   - Смешивание форм объектов
   - Блокирование специализации типов

## Лицензия

MIT 